let createComment=function(e){$(document).on("submit",`#comment-form-${e}`,(function(e){e.preventDefault();let t=$(this);$.ajax({type:"post",url:"/comments/create",data:t.serialize(),success:function(e){let t=newCommentDom(e.data.comment);$(`#post-comments-${e.data.comment.post._id}`).prepend(t),deleteComment($(" .delete-comment-button",t)),new ToggleLike($(" .toggle-like-button",t)),new Noty({theme:"relax",text:"Comment published!",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},newCommentDom=function(e){return $(`\n        <li id="comment-${e._id}">\n            <small>\n                <b>${e.user.name}:</b>${e.content}\n                <small>\n                    <small>\n                        <a class="toggle-like-button" data-likes="0" href="/likes/toggle/?id=${e._id}&type=Comment">0 Likes</a>\n                    </small>\n                    <a href="/comments/destroy/${e._id}" class="delete-comment-button">\n                        <i class="fa-solid fa-trash"></i>\n                    </a>\n                </small>\n            </small>\n        </li>\n    `)},deleteComment=function(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#comment-${e.data.comment_id}`).remove(),new Noty({theme:"relax",text:"Comment Deleted",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))};$(document).ready((function(){$(".delete-comment-button").each((function(){deleteComment(this)})),$(".comment-form").each((function(){let e=$(this).find('input[name="post"]').val();createComment(e)}))}));